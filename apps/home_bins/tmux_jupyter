#!/bin/bash

# if 'jupyter' session exists, attach to it.
# otherwise, create it with the following windows:
#   - editor: vim
#   - server: jupyter notebook

tmux has-session -t jupyter

if [ $? != 0 ]
then
    # editor window
    tmux new -s jupyter -n editor -d
    tmux send-keys -t jupyter:editor 'cd ~/jupyter_notebooks' C-m
    tmux send-keys -t jupyter:editor 'vim .' C-m

    # server window
    tmux new-window -t jupyter -n server
    tmux send-keys -t jupyter:server 'cd ~/jupyter_notebooks' C-m
    tmux send-keys -t jupyter:server 'docker run -it -p 8888:8888 -v ~/jupyter_notebooks:/home/gopher/jupyter_notebooks yunabe/lgo' C-m
fi

# select window 'editor'
tmux select-window -t jupyter:editor

# attach to session
tmux ls | grep attached
if [ $? == 0 ]; then
    tmux switch -t jupyter
else
    tmux attach -t jupyter
fi
